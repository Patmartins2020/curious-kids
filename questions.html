<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Curious Kids – Question Wall</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --card-bg:#ffffff;
      --bg:#f7fbff;
      --text:#1f2933;
      --muted:#6b7280;
      --shadow-soft:0 10px 25px rgba(15,23,42,0.08);
      --radius-lg:18px;
      --font-main:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    }
    *{box-sizing:border-box;margin:0;padding:0;}

    body{
      font-family:var(--font-main);
      background:radial-gradient(circle at top,#e0f2ff 0,#f7fbff 45%,#ffffff 100%);
      color:var(--text);
      min-height:100vh;
    }
    a{text-decoration:none;color:inherit;}

    /* =========================
       HEADER + NAV (MATCH index.html)
       ========================= */
    .ck-header {
      position: sticky;
      top: 0;
      z-index: 50;
      background: #10b981; /* Curious Kids green */
      color: #ffffff;
    }

    .nav-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0.6rem 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .brand-logo {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: conic-gradient(
        from 180deg,
        #ff8a3d,
        #ffd74d,
        #4d8fff,
        #ff8a3d
      );
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 800;
      font-size: 1.1rem;
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.25);
      cursor: pointer;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
      line-height: 1.1;
    }

    .brand-text span:first-child {
      font-weight: 800;
      font-size: 1rem;
      letter-spacing: 0.03em;
    }

    .brand-text span:last-child {
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.85);
    }

    /* Desktop nav */
    .main-nav ul {
      list-style: none;
      display: flex;
      gap: 0.75rem;
      font-size: 0.9rem;
      align-items: center;
    }

    .main-nav a {
      padding: 0.35rem 0.8rem;
      border-radius: 999px;
      font-weight: 500;
      color: #e5fdf4;
      transition: background 0.15s, color 0.15s, transform 0.1s;
      text-decoration: none;
    }

    .main-nav a:hover {
      background: rgba(255, 255, 255, 0.14);
      color: #ffffff;
      transform: translateY(-1px);
    }

    .nav-cta {
      background: #ffffff;
      color: #10b981 !important;
      box-shadow: 0 3px 10px rgba(15, 118, 110, 0.4);
      text-align: center;
    }

    /* Mobile toggle – dash style */
    .nav-toggle {
      display: none;
      font-size: 2rem;
      background: none;
      border: none;
      color: #ffffff;
      cursor: pointer;
      line-height: 1;
    }

    /* Mobile menu behaviour (same as index) */
    @media (max-width: 768px) {
      .nav-toggle {
        display: block;
      }

      .nav-inner {
        position: relative;
      }

      .main-nav {
        position: absolute;
        right: 1rem;
        top: calc(100% + 0.4rem);
        display: none;
        background: rgba(3, 7, 18, 0.96); /* very dark (almost black) */
        border-radius: 18px;
        box-shadow: 0 18px 40px rgba(15, 23, 42, 0.6);
        padding: 0.4rem 0.5rem 0.6rem;
        min-width: 210px;
      }

      .main-nav ul {
        flex-direction: column;
        gap: 0.15rem;
        padding: 0;
        margin: 0;
      }

      .main-nav a {
        display: block;
        padding: 0.6rem 0.75rem;
        color: #ffffff;
        border-radius: 999px;
      }

      .main-nav a:hover {
        background: rgba(255, 255, 255, 0.12);
        transform: none;
      }

      .main-nav.open {
        display: block;
      }

      .nav-cta {
        margin-top: 0.25rem;
      }
    }

    /* =========================
       MAIN CONTENT
       ========================= */
    main{
      max-width:1100px;
      margin:0 auto;
      padding:1.5rem 1rem 2.5rem;
    }

    /* Green top block with white text for title + intro */
    .section-header{
      margin-bottom:.9rem;
      background:#16a34a;
      border-radius:var(--radius-lg);
      padding:1rem 1rem;
      box-shadow:var(--shadow-soft);
      color:#ffffff;
    }
    .section-header h1{
      font-size:1.5rem;
      margin-bottom:.25rem;
      color:#ffffff;
    }
    .section-header p{
      font-size:.9rem;
      color:rgba(255,255,255,0.9);
    }

    .card{
      background:var(--card-bg);
      border-radius:var(--radius-lg);
      padding:1.1rem 1rem;
      box-shadow:var(--shadow-soft);
      border:1px solid rgba(148,163,184,0.18);
    }

    .question-card{
      background:#fff;
      border-radius:var(--radius-lg);
      border:1px solid rgba(148,163,184,.25);
      padding:.8rem .85rem .75rem;
      margin-bottom:.7rem;
      box-shadow:0 4px 12px rgba(15,23,42,.04);
      font-size:.85rem;
    }
    .question-category{
      font-size:.7rem;
      padding:.15rem .5rem;
      border-radius:999px;
      background:rgba(59,130,246,.08);
      color:#1d4ed8;
      font-weight:600;
    }
    .question-meta{font-size:.7rem;color:var(--muted);}
    .question-text{margin:.2rem 0 .3rem;}
    .question-nickname{font-size:.74rem;color:#6b7280;}
    .question-status{
      display:inline-flex;
      align-items:center;
      gap:.25rem;
      margin-top:.2rem;
      font-size:.7rem;
      padding:.15rem .45rem;
      border-radius:999px;
      background:rgba(234,179,8,.08);
      color:#854d0e;
    }
    .question-status::before{content:"•";}

    .empty-state{
      font-size:.85rem;
      color:var(--muted);
      background:#eff6ff;
      border-radius:var(--radius-lg);
      padding:.9rem .8rem;
      border:1px dashed rgba(129,140,248,.7);
    }

    /* ANSWERS BELOW EACH QUESTION */

    .answers-container{
      margin-top:0.6rem;
      padding-top:0.6rem;
      border-top:1px dashed rgba(148,163,184,0.6);
    }

    .answers-title{
      font-size:0.8rem;
      font-weight:600;
      color:#4b5563;
      margin-bottom:0.25rem;
    }

    .answer-item{
      border-radius:10px;
      border:1px solid rgba(148,163,184,0.3);
      padding:0.45rem 0.5rem;
      margin-bottom:0.35rem;
      background:#f9fafb;
    }

    .answer-meta{
      font-size:0.7rem;
      color:#6b7280;
      margin-bottom:0.15rem;
    }

    .answer-body{
      font-size:0.82rem;
      color:#111827;
    }

    .answer-empty{
      font-size:0.8rem;
      color:var(--muted);
      margin-bottom:0.4rem;
    }

    .answer-form{
      margin-top:0.4rem;
      padding-top:0.4rem;
      border-top:1px solid rgba(209,213,219,0.8);
      font-size:0.78rem;
    }

    .answer-form label{
      display:block;
      margin-bottom:0.25rem;
    }

    .answer-form span{
      display:block;
      margin-bottom:0.05rem;
      color:#4b5563;
      font-size:0.75rem;
      font-weight:500;
    }

    .answer-form input,
    .answer-form textarea{
      width:100%;
      border-radius:10px;
      border:1px solid rgba(148,163,184,0.9);
      padding:0.35rem 0.5rem;
      font-size:0.8rem;
      font-family:inherit;
      background:#f9fafb;
      resize:vertical;
    }

    .answer-button{
      margin-top:0.35rem;
      border-radius:999px;
      border:none;
      padding:0.4rem 0.9rem;
      font-size:0.78rem;
      font-weight:600;
      cursor:pointer;
      background:#ff8a3d;
      color:#ffffff;
      box-shadow:0 4px 10px rgba(248,113,22,0.45);
    }

    .answer-button:hover{
      background:#e46f22;
    }

    .answer-hint{
      margin-top:0.2rem;
      font-size:0.7rem;
      color:var(--muted);
    }

    footer{
      margin-top:2.8rem;
      padding:1.2rem 1rem 1.8rem;
      font-size:.75rem;
      color:var(--muted);
      border-top:1px solid rgba(148,163,184,0.25);
      text-align:center;
    }
  </style>
</head>
<body>

<header class="ck-header">
  <div class="nav-inner">
    <div class="brand">
      <div class="brand-logo">CK</div>
      <div class="brand-text">
        <span>Curious Kids Q&A</span>
        <span>Ask big questions. Get gentle answers.</span>
      </div>
    </div>

    <!-- MOBILE MENU BUTTON (dash) -->
    <button class="nav-toggle" aria-label="Toggle Menu">━</button>
  </div>

  <nav class="main-nav">
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="ask.html">Ask a Question</a></li>
      <li><a href="questions.html">Question Wall</a></li>
      <li><a href="store.html">Store</a></li>
      <li><a href="parents.html">For Parents</a></li>
      <li><a href="forum.html">Adult Forum</a></li>
      <li><a href="legal.html">Legal</a></li>
      <li><a href="ask.html" class="nav-cta">Ask Now</a></li>
    </ul>
  </nav>
</header>

<main>
  <section class="section-header">
    <h1>Question Wall</h1>
    <p>
      This wall shows only <strong>public questions</strong> asked from this browser.
      Private and adult consultation questions are kept hidden and never displayed here.
      Adults and teachers can add gentle answers below each question (local demo).
    </p>
  </section>

  <section class="card">
    <div id="questionsList" aria-live="polite"></div>
  </section>
</main>

<footer>
  <p>
    © <span id="year"></span> Curious Kids Q&amp;A.
    All rights reserved.
  </p>
  <p style="margin-top:0.25rem;">
    <a href="legal.html#terms">Terms of Service</a> ·
    <a href="legal.html#privacy">Privacy Policy</a> ·
    <a href="legal.html#cookies">Cookies</a>
  </p>
</footer>

<script>
  const STORAGE_KEY = "curiousKidsQuestions";
  const ADMIN_CODE = "CKADMIN2025";

  function escapeHtml(str){
    if(!str) return "";
    return String(str).replace(/[&<>"']/g,ch =>
      ({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[ch] || ch)
    );
  }

  function loadQuestions(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return [];
      const parsed = JSON.parse(raw);
      return Array.isArray(parsed)?parsed:[];
    }catch{return [];}
  }

  function saveQuestions(list){
    try{localStorage.setItem(STORAGE_KEY,JSON.stringify(list));}catch{}
  }

  function renderQuestions(){
    const container=document.getElementById("questionsList");
    if(!container) return;
    const all = loadQuestions();
    const publicQs = all.filter(q => !q.isPrivate);

    // ensure answers array exists
    publicQs.forEach(q => {
      if (!Array.isArray(q.answers)) q.answers = [];
    });

    if(!publicQs.length){
      container.innerHTML =
        '<p class="empty-state">No public questions on this device yet. Be the first to ask on the Ask page!</p>';
      return;
    }

    container.innerHTML = publicQs.map((q,index)=>{
      const nickname = q.nickname ? "From: "+escapeHtml(q.nickname) : "";
      const meta = escapeHtml(q.who || "Kid") + " • " +
                   escapeHtml(q.ageRange || "Age not said");
      const answers = q.answers || [];

      const answersHtml = answers.length
        ? answers.map(a => `
          <div class="answer-item">
            <div class="answer-meta">
              ${escapeHtml(a.author || "Adult helper")}
              ${a.createdAt ? " · " + escapeHtml(new Date(a.createdAt).toLocaleString()) : ""}
            </div>
            <div class="answer-body">${escapeHtml(a.body || "")}</div>
          </div>
        `).join("")
        : `<p class="answer-empty">No answers yet. You can be the first to answer kindly.</p>`;

      return `
      <article class="question-card">
        <header style="display:flex;justify-content:space-between;align-items:baseline;gap:.5rem;">
          <span class="question-category">${escapeHtml(q.category || "Question")}</span>
          <span class="question-meta">${meta}</span>
        </header>
        <p class="question-text">${escapeHtml(q.questionText)}</p>
        ${nickname ? `<p class="question-nickname">${nickname}</p>` : ""}
        <span class="question-status">Waiting for answer</span>

        <div class="answers-container">
          <h3 class="answers-title">Answers</h3>
          ${answersHtml}
          <div class="answer-form">
            <label>
              <span>Your name or role (optional)</span>
              <input type="text" id="answerName-${index}" maxlength="40"
                     placeholder="e.g. Mum in Lagos, Teacher Ada" />
            </label>
            <label>
              <span>Your answer</span>
              <textarea id="answerBody-${index}" rows="3"
                placeholder="Write a short, kind answer suitable for a child."></textarea>
            </label>
            <button type="button" class="answer-button" onclick="submitAnswer(${index})">
              ✨ Post Answer (local demo)
            </button>
            <p class="answer-hint">
              Please be gentle and do not share phone numbers, email addresses or links.
            </p>
          </div>
        </div>
      </article>`;
    }).join("");

    // save any structural changes (like added answers array)
    saveQuestions(all);
  }

  // Called when an adult posts an answer under a question
  function submitAnswer(publicIndex){
    const all = loadQuestions();
    const publicQs = all.filter(q => !q.isPrivate);
    if (publicIndex < 0 || publicIndex >= publicQs.length) return;

    const q = publicQs[publicIndex];
    if (!Array.isArray(q.answers)) q.answers = [];

    const nameInput = document.getElementById(`answerName-${publicIndex}`);
    const bodyInput = document.getElementById(`answerBody-${publicIndex}`);
    if (!bodyInput) return;

    const author = (nameInput && nameInput.value ? nameInput.value.trim() : "");
    const body = bodyInput.value.trim();

    if (body.length < 5){
      alert("Please write a bit more so your answer is helpful.");
      return;
    }

    const lower = body.toLowerCase();
    if (lower.includes("@") || lower.includes("http")){
      alert("Please do not include email addresses or links in your answer.");
      return;
    }

    q.answers.push({
      author: author || "Adult helper",
      body,
      createdAt: new Date().toISOString()
    });

    saveQuestions(all);

    if (nameInput) nameInput.value = "";
    bodyInput.value = "";

    renderQuestions();
  }

  // Optional: clear only public questions (keeps private ones)
  function clearPublicQuestions(){
    if(!confirm("Clear all PUBLIC questions on this device? Private questions will be kept.")) return;
    const all = loadQuestions();
    const keep = all.filter(q => q.isPrivate);
    saveQuestions(keep);
    renderQuestions();
  }

  document.addEventListener("DOMContentLoaded",()=>{
    const y=document.getElementById("year");
    if(y) y.textContent=new Date().getFullYear();
    renderQuestions();
  });

  // Admin access to admin.html via 5-click on logo
  (function () {
    const logo = document.querySelector(".brand-logo");
    if (!logo) return;

    let clicks = 0;
    let timer = null;

    logo.addEventListener("click", () => {
      clicks++;
      if (timer) clearTimeout(timer);
      // reset counter after 2.5 seconds
      timer = setTimeout(() => {
        clicks = 0;
      }, 2500);

      if (clicks >= 5) {
        clicks = 0;
        const code = prompt("Admin access code:");
        if (code === ADMIN_CODE) {
          window.location.href = "admin.html";
        } else if (code) {
          alert("Incorrect code.");
        }
      }
    });
  })();

  // Mobile nav toggle – same behaviour as index.html
  (function () {
    const toggleBtn = document.querySelector(".nav-toggle");
    const mainNav = document.querySelector(".main-nav");
    if (!toggleBtn || !mainNav) return;

    toggleBtn.addEventListener("click", () => {
      mainNav.classList.toggle("open");
    });
  })();
</script>

</body>
</html>